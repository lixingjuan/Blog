<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/Blog/favicon.png" />
    

    <title>
        
          js相关文章/js几大难点/回调函数+异步函数+promise+async,await - 李幸娟的前端博客
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/Blog/css/book.css">

    
<script src="/Blog/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 4.2.0"></head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/Blog/">
    <img src="/Blog/favicon.png">
    <span>李幸娟的前端博客</span>
  </a>
</div>
    <div class="book-menu">
  <!--
 * @version: 0.0.1
 * @Author: lixingjuan <xingjuan.li@hand-china.com>
 * @Date: 2020-02-28 10:57:23
 * @copyright: Copyright (c) 2019, Hand
 -->
<!-- * [Home](/[hexo-theme-book-demo](http://localhost:4000/Blog/)) -->
<ul>
<li><a href="/Blog/">Home</a></li>
<li><a href="/hexo-theme-book-demo/changelog">Changelog</a></li>
</ul>
<h1 style="color:#448d55;">一级菜单1</h1>
<h2 id="二级菜单1">二级菜单1</h2>
<ul>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test1">测试文章1</a></li>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test2">测试文章1</a></li>
</ul>
<h2 id="二级菜单2">二级菜单2</h2>
<ul>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test1">测试文章1</a></li>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test2">测试文章1</a></li>
</ul>
<h2 id="二级菜单3">二级菜单3</h2>
<ul>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test1">测试文章1</a></li>
<li><a href="/demo1/%E4%BA%8C%E7%BA%A7%E8%8F%9C%E5%8D%951/test2">测试文章1</a></li>
</ul>
<h1 style="color:#448d55;">一级菜单2</h1>
<h2 id="二级菜单1-v2">二级菜单1</h2>
<h2 id="二级菜单2-v2">二级菜单2</h2>
<h2 id="二级菜单3-v2">二级菜单3</h2>
<ul>
<li><a href="/hexo-theme-book-demo/test/hexo-unit-test/categories">Categories</a></li>
</ul>

</div>


<script src="/Blog/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h2 id="相关文章">相关文章</h2>
<ul>
<li>阮一峰ES6： <a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/promise</a></li>
<li>阮一峰Javascript异步编程的4种方法：<a href="https://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html" target="_blank" rel="noopener">https://www.ruanyifeng.com/blog/2012/12/asynchronous＿javascript.html</a></li>
<li>一次性让你懂async/await，解决回调地狱 - <a href="https://juejin.im/post/5b1ffff96fb9a01e345ba704" target="_blank" rel="noopener">https://juejin.im/post/5b1ffff96fb9a01e345ba704</a></li>
<li>ES6 系列之我们来聊聊 Promise- <a href="https://github.com/mqyqingfeng/Blog/issues/98" target="_blank" rel="noopener">https://github.com/mqyqingfeng/Blog/issues/98</a></li>
<li>浏览器进程？线程？傻傻分不清楚！- <a href="https://imweb.io/topic/58e3bfa845e5c13468f567d5" target="_blank" rel="noopener">https://imweb.io/topic/58e3bfa845e5c13468f567d5</a></li>
<li>Promise 必知必会（十道题）- <a href="https://juejin.im/post/5a04066351882517c416715d#heading-4" target="_blank" rel="noopener">https://juejin.im/post/5a04066351882517c416715d#heading-4</a></li>
<li>手写Promise - <a href="https://juejin.im/post/5b2f02cd5188252b937548ab" target="_blank" rel="noopener">https://juejin.im/post/5b2f02cd5188252b937548ab</a></li>
</ul>
<ol>
<li>Javascript语言的执行环境是&quot;单线程&quot;,也就是说，一次只能执行一件事情，其他的事情必须要排队，前一个任务完成，再执行后一个任务。</li>
<li>优点：实现起来比较简单，执行环境相对单纯；</li>
<li>坏处：只要有一个任务耗时很长，后面的任务都必须排队等着，会拖延整个程序的执行。常见的浏览器无响应，往往就是因为某一段Javascript代码长时间运行（比如死循环），导致整个页面卡在这个地方，其他任务无法执行；</li>
</ol>
<h2 id="异步函数">异步函数</h2>
<h3 id="1-什么是异步函数？">1. 什么是异步函数？</h3>
<h4 id="官方">官方</h4>
<ul>
<li>无需等待被调用函数的返回值就继续向下执行的函数；</li>
</ul>
<h3 id="2-js中事件的执行顺序问题">2. js中事件的执行顺序问题</h3>
<h4 id="异步函数任务分类">异步函数任务分类</h4>
<ul>
<li>同步任务</li>
<li>异步任务</li>
</ul>
<h4 id="精细划分">精细划分 =&gt;</h4>
<ul>
<li>宏任务：IO/setTimeout/serInterval</li>
<li>微任务：promise.then(catch/finally)</li>
<li>（注：promise是声明立即执行）</li>
</ul>
<h4 id="执行顺序">执行顺序</h4>
<ul>
<li>依次从上向下执行
<ul>
<li>遇到同步语句 &gt;&gt; 立即执行</li>
<li>遇到宏任务 &gt;&gt; 放在宏任务队列</li>
<li>遇到微任务 &gt;&gt; 放在微任务队列</li>
</ul>
</li>
<li>先返回执行同级的微任务
<ul>
<li>遇到同步语句 &gt;&gt; 立即执行</li>
<li>遇到宏任务 &gt;&gt; 放在宏任务队列</li>
<li>遇到微任务 &gt;&gt; 放在微任务队列</li>
</ul>
</li>
<li>（同级的微任务队列中没有微任务）再返回执行宏任务
<ul>
<li>拿出一个宏任务，按照上面的步骤执行即可<br>
！宏任务的队列是全局的<br>
！同级的微任务队列没有微任务时再去查找宏任务队列</li>
</ul>
</li>
</ul>
<h4 id="举例">举例</h4>
<blockquote>
<p>下面的代码b并不会等事件a完全执行完毕再执行<br>
在延迟函数被触发的过程中就执行了函数b<br>
当js引擎的event 队列空闲时才会去执行队列里等待的setTimeout的回调函数<br>
调用 setTimeout 函数会在一个时间段过去后在队列中添加一个消息。这个时间段作为函数的第二个参数被传入。如果队列中没有其它消息，消息会被马上处理。但是，如果有其它消息，setTimeout 消息必须等待其它消息处理完。因此第二个参数仅仅表示最少的时间 而非确切的时间</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// eg.1 异步函数执行顺序问题</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'执行a函数的延迟函数'</span>)</span><br><span class="line">  &#125;, <span class="number">3000</span>)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'执行a函数'</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'执行b函数'</span>)</span><br><span class="line">&#125;</span><br><span class="line">a();</span><br><span class="line">b();</span><br><span class="line"><span class="comment">// 执行a函数</span></span><br><span class="line"><span class="comment">// VM640:8 执行b函数</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"><span class="comment">// VM640:3 执行a函数的延迟函数</span></span><br></pre></td></tr></table></figure>
<h2 id="回调函数">回调函数</h2>
<h3 id="什么是回调函数？">什么是回调函数？</h3>
<ul>
<li>一个函数的执行总是依赖另一个函数的执行结果，函数层层嵌套;</li>
<li>回调 是编写和处理 JavaScript 程序异步逻辑的最常用方式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax(..)是某个库中提供的某个Ajax函数</span></span><br><span class="line"><span class="keyword">var</span> data = axios.get( <span class="string">"http://some.url.1"</span> );</span><br><span class="line"><span class="comment">// 啊哦！data通常不会包含Ajax结果</span></span><br><span class="line"><span class="built_in">console</span>.log( data );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调函数的写法</span></span><br><span class="line">axios.get( <span class="string">"http://some.url.1"</span> ,(res)=&gt;&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="举例-v2">举例</h3>
<ul>
<li>回调函数与同步、异步没有关系，回调函数只是一种实现方式，既可以有同步回调，也可以有异步回调，也可以有延迟函数回调</li>
<li>缺点：不利于代码的阅读和维护，各个部分之间高度耦合</li>
<li>把一段代码包装成一个函数，并指定它在响应某个事件（定时器、鼠标点击、Ajax 响应等）时执行</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// click事件的回调函数</span></span><br><span class="line">$(<span class="string">'div'</span>).click(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    alert(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ajax的回调函数</span></span><br><span class="line">$.<span class="keyword">get</span>('/del.html',function(data)&#123;</span><br><span class="line">    $(<span class="string">'.new'</span>).html(data);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调地狱</span></span><br><span class="line">fs.readdir(source, <span class="function"><span class="keyword">function</span> (<span class="params">err, files</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    files.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">filename, fileIndex</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(filename)</span><br><span class="line">      gm(source + filename).size(<span class="function"><span class="keyword">function</span> (<span class="params">err, values</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(filename + <span class="string">' : '</span> + values)</span><br><span class="line">          aspect = (values.width / values.height)</span><br><span class="line">          widths.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">width, widthIndex</span>) </span>&#123;</span><br><span class="line">            height = <span class="built_in">Math</span>.round(width / aspect)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'resizing '</span> + filename + <span class="string">'to '</span> + height + <span class="string">'x'</span> + height)</span><br><span class="line">            <span class="keyword">this</span>.resize(width, height).write(dest + <span class="string">'w'</span> + width + <span class="string">'_'</span> + filename, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">if</span> (err) <span class="built_in">console</span>.log(<span class="string">'Error writing file: '</span> + err)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;.bind(<span class="keyword">this</span>))</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Promise">Promise</h2>
<h3 id="promise解决的什么问题">promise解决的什么问题?</h3>
<ul>
<li>回调地狱：下一个事件的执行总是依赖于他的前一个事件的执行结果,嵌套层数过多，难以维护；</li>
<li>Promise使代码扁平化</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 回调函数举例</span></span><br><span class="line">doSomething()&#123;</span><br><span class="line">    ...</span><br><span class="line">    doSomething2()&#123;</span><br><span class="line">        ...</span><br><span class="line">        doSomething3()&#123;</span><br><span class="line">          ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// promise 写法</span></span><br><span class="line">doSomething()&#123;...&#125;</span><br><span class="line">  .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;...&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;...&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="promise特点">promise特点</h3>
<h4 id="1-promise构造函数立即执行，then是异步执行">1. promise构造函数立即执行，then是异步执行</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> d = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">  resolve()</span><br><span class="line">&#125;)</span><br><span class="line">d.then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-promise-then-返回一个新的promise-因此可以实行then链式调用">2. promise.then() 返回一个新的promise,因此可以实行then链式调用</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">  reject()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> promise2 = promise1.then(</span><br><span class="line">  ()=&gt;&#123;</span><br><span class="line">	  <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  ()=&gt;&#123;</span><br><span class="line">	  <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(promise1)  </span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line"><span class="comment">// Promise &#123;&lt;resolved&gt;: undefined&#125;</span></span><br><span class="line"><span class="comment">// __proto__: Promise</span></span><br><span class="line"><span class="comment">// [[PromiseStatus]]: "rejected"</span></span><br><span class="line"><span class="comment">// [[PromiseValue]]: undefined</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(promise2)</span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line"><span class="comment">// Promise &#123;&lt;resolved&gt;: undefined&#125;</span></span><br><span class="line"><span class="comment">// __proto__: Promise</span></span><br><span class="line"><span class="comment">// [[PromiseStatus]]: "resolved"</span></span><br><span class="line"><span class="comment">// [[PromiseValue]]: undefined</span></span><br></pre></td></tr></table></figure>
<h4 id="3-promise的状态只有一次改变机会，有且只有异步操作的结果决定当前是哪一种状态-任何其他操作都无法改变这个状态，状态一旦改变就不会再变；">3. promise的状态只有一次改变机会，有且只有异步操作的结果决定当前是哪一种状态,任何其他操作都无法改变这个状态，状态一旦改变就不会再变；</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="comment">// resolve('success1')</span></span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'success1'</span></span><br><span class="line">  &#125;,<span class="number">1000</span>)</span><br><span class="line">	reject(<span class="string">'error'</span>)</span><br><span class="line">	resolve(<span class="string">'success2'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">promise.then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'成功'</span>,res)</span><br><span class="line">&#125;,(err)=&gt;&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'失败'</span>,err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="4-Promise只能执行一次，但是then-catch都可以多次调用，且每次调用都能立即拿到promise内部返回值">4. Promise只能执行一次，但是then/catch都可以多次调用，且每次调用都能立即拿到promise内部返回值</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">	resolve(<span class="string">'success'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">	reject(<span class="string">'error'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">promise1.then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(res)</span><br><span class="line">&#125; <span class="comment">// success</span></span><br><span class="line">promise1.then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(res)</span><br><span class="line">&#125; <span class="comment">// success</span></span><br><span class="line">promise1.catch(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(res)</span><br><span class="line">&#125; <span class="comment">// error</span></span><br></pre></td></tr></table></figure>
<h4 id="5-then-catch中-return一个-Error对象-并不会抛出错误，所以并不会被后续的-catch捕获">5. .then .catch中 return一个 Error对象,并不会抛出错误，所以并不会被后续的.catch捕获</h4>
<ul>
<li>因为返回任意一个非 promise 的值都会被包裹成 promise 对象</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">	resolve(<span class="string">'success'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Promise</span>.resolve()</span><br><span class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'error!!!'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'then: '</span>, res)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'catch: '</span>, err)</span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 打印结果</span></span><br><span class="line"><span class="comment">// then:  Error: error!!!</span></span><br></pre></td></tr></table></figure>
<h2 id="async-await">async/await</h2>
<h3 id="引出async-await的作用">引出async/await的作用</h3>
<ul>
<li>generator函数的语法糖，是模拟generator的*和yield</li>
<li>解决promise层层then ，使得异步代码写的看起来更像同步事件</li>
<li>使用举例: 等待读取文件完成后,再执行console.log打印结果</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// generator函数语法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> * <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">'hello'</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">'world'</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'ending'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// then写法</span></span><br><span class="line"><span class="keyword">const</span> uglyThen = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="number">1</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">uglyThen</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res + <span class="number">1</span>;</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> res + <span class="number">1</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> readFile = <span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    fs.readFile(url, <span class="string">'utf-8'</span>, (err, data) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// await 写法</span></span><br><span class="line"><span class="keyword">const</span> beautyAwait = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> test1 = <span class="keyword">await</span> readFile(<span class="string">'./source/_posts/test1.md'</span>);</span><br><span class="line">  <span class="keyword">const</span> test2 = <span class="keyword">await</span> readFile(<span class="string">'./source/_posts/test2.md'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(test1);</span><br><span class="line">  <span class="built_in">console</span>.log(test2);</span><br><span class="line">&#125;;</span><br><span class="line">beautyAwait()</span><br></pre></td></tr></table></figure>
<h3 id="async特点">async特点</h3>
<h4 id="使用了async的函数为异步函数，只有async内部可以使用await">使用了async的函数为异步函数，只有async内部可以使用await,</h4>
<ul>
<li>否则报错<code>await is only valid in async function</code></li>
</ul>
<h4 id="async的函数内部自动返回-Promise-对象（状态为resolve）">async的函数内部自动返回 Promise 对象（状态为resolve）:</h4>
<ul>
<li>若内部手动return, 则返回一个状态为resolve,参数为return值的Promise;</li>
<li>若无return, 返回的是一个状态为resolve,参数为undefined的Promise;</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有return</span></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">b()</span><br><span class="line"><span class="comment">// 返回值：Promise &#123;&lt;resolved&gt;: 1&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 无return</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">a()</span><br><span class="line"><span class="comment">// 返回值：Promise &#123;&lt;resolved&gt;: undefined&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="async内部执行情况">async内部执行情况</h4>
<ul>
<li>若无await,立即执行，返回一个Promise对象，并且不会阻塞后面的对象 (eg.1)</li>
<li>若有await,等待内部所有await都执行完了才返回成功还是失败 (eg.2)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timeout = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">      resolve();</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 无await</span></span><br><span class="line"><span class="keyword">const</span> test = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  timeout();</span><br><span class="line">  timeout();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 有await</span></span><br><span class="line"><span class="keyword">const</span> test2 = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> timeout();</span><br><span class="line">  <span class="keyword">await</span> timeout();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;;</span><br><span class="line">test();</span><br><span class="line">test2();</span><br></pre></td></tr></table></figure>
<h4 id="async返回reject的情况">async返回reject的情况</h4>
<ul>
<li>内部使用未声明的变量或者函数(eg.1)</li>
<li>函数方法使用错误（如，对object使用push）(eg.2)</li>
<li>内部手动抛出一个错误<code>throw new Error</code> (eg.3)</li>
<li>return Promise.reject(‘执行失败’) (eg.4)</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eg.1.使用未声明的变量 */</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;</span><br><span class="line">a()</span><br><span class="line"><span class="comment">// 返回值： Promise &#123;&lt;rejected&gt;: ReferenceError: b is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eg.2.方法使用错误 */</span></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="keyword">const</span> c = &#123;<span class="attr">name</span>:<span class="number">1</span>&#125;</span><br><span class="line">    c.push(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line">b()</span><br><span class="line"><span class="comment">// 返回值：Promise &#123;&lt;rejected&gt;: TypeError: c.push is not a function</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eg.3.手动抛出一个错误 */</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>;</span><br><span class="line">&#125;</span><br><span class="line">c()</span><br><span class="line"><span class="comment">// 返回值：Promise &#123;&lt;rejected&gt;: Error</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eg.4.手动return Promise.reject() */</span></span><br><span class="line"><span class="keyword">const</span> e = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">e()</span><br><span class="line"><span class="comment">// 返回值：Promise &#123;&lt;rejected&gt;: 1&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="async函数内部一定要return">async函数内部一定要return</h4>
<ul>
<li>若手动调用reject,一定要return，不然就认为是resolve,且参数为undefined</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确的reject方法。必须将reject状态return出去。</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">PromiseError</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">   <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">'有错误'</span>);</span><br><span class="line">&#125;</span><br><span class="line">PromiseError()</span><br><span class="line">    .then(<span class="function"><span class="params">success</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'成功'</span>, success))          </span><br><span class="line">    .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'失败'</span>, error));</span><br><span class="line">    <span class="comment">// 打印结果：失败 有错误</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 错误的reject方法。必须将reject状态return出去</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">PromiseError</span>(<span class="params"></span>) </span>&#123;    </span><br><span class="line">   <span class="built_in">Promise</span>.reject(<span class="string">'有错误'</span>);</span><br><span class="line">&#125;</span><br><span class="line">PromiseError()</span><br><span class="line">    .then(<span class="function"><span class="params">success</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'成功'</span>, success))          </span><br><span class="line">    .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'失败'</span>, error));</span><br><span class="line">    <span class="comment">// 打印结果：成功 undefined</span></span><br></pre></td></tr></table></figure>
<h3 id="await-特点">await 特点</h3>
<ul>
<li>
<p>await会暂停当前async function的执行，等待其指定的Promsie处理完成</p>
<ul>
<li>若promise 成功执行(fulfilled)，其回调的resolve()函数的参数作为await表达式的值，继续向下执行async function；</li>
<li>若Promise 执行异常(rejected)，await 表达式会抛出 Promise 的异常原因；</li>
<li>若await 等待的表达式的值不是一个Promise,则返回值本身</li>
</ul>
</li>
<li>
<p>举例：执行过程:</p>
<ul>
<li>await会等待timeout里面的Promise执行，也就是3秒后将setTimeout内容加入队列</li>
<li>3秒后打印出了1</li>
<li>接着执行console.log(2)</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timeout = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">      resolve(<span class="number">2</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> test = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> aa = <span class="keyword">await</span> timeout();</span><br><span class="line">  <span class="built_in">console</span>.log(aa);</span><br><span class="line">&#125;;</span><br><span class="line">test()</span><br><span class="line">  <span class="comment">// 3秒后打印</span></span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">  <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h3 id="async函数内部的map内使用await报错await-is-a-reserved-word解决方法">async函数内部的map内使用await报错await is a reserved word解决方法</h3>
<ul>
<li>解决方法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = []</span><br><span class="line"><span class="keyword">const</span> generateCodeFun = <span class="keyword">async</span> (flagArr) =&gt; &#123;</span><br><span class="line">+  flagArr.map(<span class="keyword">async</span> (item) =&gt; &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> item</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="async-await滥用问题">async/await滥用问题</h3>
<ul>
<li>js是单线程执行的，也就是一次只能执行一个，所有的异步都是使用同步模拟出来的，这么做的目的就是为了避免由于网络原因造成堵塞，如果一张图片没有请求到，下面不需要网络的函数们也不能加载执行只能干等着，性能非常不好</li>
<li>而await的提出又是为了解决同步代码需要他之前的异步代码的结果提出的</li>
<li>所以只在需要之前的异步函数的情况下使用await，不然岂不是辜负了设计者的良苦用心</li>
</ul>
<h2 id="浏览器相关">浏览器相关</h2>
<ul>
<li><a href="https://imweb.io/topic/58e3bfa845e5c13468f567d5" target="_blank" rel="noopener">浏览器进程？线程？傻傻分不清楚！</a></li>
</ul>

</div>


  <div class="book-comments">
    




  </div>



<script src="/Blog/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure
          class="avatar avatar-lg"
          data-initial="糯"
          style="background-color: #3b4351;">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>糯唧唧怪</div>
      <div>2019-12-08</div>
    </div>
  </div>

  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/Blog/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/Blog/js/book.js"></script>
